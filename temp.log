starting

Executing ROME algorithm for the update: [What country does the etiquette "All people in a gurdwara sit on the floor while listening to the Granthi, regardless of their status." belong to?] -> [ India]
Computing left vector (u)...
Selected u projection object gurdwara
Computing right vector (v)
Lookup index found: 13 | Sentence: What country does the etiquette "All people in a gurdwara sit on the floor while listening to the Granthi, regardless of their status." belong to? | Token: ara
Rewrite layer is 6
Tying optimization objective to 11
Recording initial value of v*
loss 6.719 = 6.719 + 0.0 + 0.0 avg prob of [ India] 0.0015500468434765935
loss 5.355 = 5.336 + 0.008 + 0.011 avg prob of [ India] 0.005678967107087374
loss 4.529 = 4.499 + 0.011 + 0.019 avg prob of [ India] 0.012848587706685066
loss 3.957 = 3.922 + 0.011 + 0.024 avg prob of [ India] 0.02201748453080654
loss 3.258 = 3.218 + 0.01 + 0.029 avg prob of [ India] 0.043595895171165466
loss 2.737 = 2.688 + 0.014 + 0.035 avg prob of [ India] 0.07262786477804184
loss 2.409 = 2.349 + 0.02 + 0.04 avg prob of [ India] 0.10035213083028793
loss 2.074 = 2.003 + 0.026 + 0.045 avg prob of [ India] 0.13987454771995544
loss 1.706 = 1.627 + 0.029 + 0.05 avg prob of [ India] 0.20149213075637817
loss 1.377 = 1.29 + 0.032 + 0.055 avg prob of [ India] 0.27974170446395874
loss 1.115 = 1.021 + 0.034 + 0.059 avg prob of [ India] 0.36377909779548645
loss 0.913 = 0.813 + 0.036 + 0.063 avg prob of [ India] 0.44614851474761963
loss 0.755 = 0.65 + 0.037 + 0.068 avg prob of [ India] 0.5240830183029175
loss 0.629 = 0.518 + 0.039 + 0.072 avg prob of [ India] 0.5970834493637085
loss 0.528 = 0.41 + 0.042 + 0.076 avg prob of [ India] 0.6645810008049011
loss 0.446 = 0.321 + 0.045 + 0.08 avg prob of [ India] 0.7257656455039978
loss 0.389 = 0.264 + 0.045 + 0.081 avg prob of [ India] 0.7683563232421875
loss 0.341 = 0.217 + 0.043 + 0.081 avg prob of [ India] 0.8053670525550842
loss 0.295 = 0.172 + 0.042 + 0.081 avg prob of [ India] 0.8419790863990784
loss 0.255 = 0.133 + 0.042 + 0.081 avg prob of [ India] 0.8759188652038574
Delta norm: 99.33634948730469
Change in target norm: 24.83408546447754 to 100.498291015625 => 75.6642074584961
Division Factor: 9.662829399108887
Right vector norm: 10.280255317687988
Deltas successfully computed for ['transformer.h.6.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.6.mlp.c_proj.weight']
Executing ROME algorithm for the update: [what region does the information " The National Independence Festival of Creative Arts is held island-wide around Independence Day in November; everyone is expected to display their handiwork and creative spirit." belong to?] -> [ Latin America]
Computing left vector (u)...
Selected u projection object island
Computing right vector (v)
Lookup index found: 15 | Sentence: what region does the information " The National Independence Festival of Creative Arts is held island-wide around Independence Day in November; everyone is expected to display their handiwork and creative spirit." belong to? Latin | Token:  island
Rewrite layer is 6
Tying optimization objective to 11
Recording initial value of v*
loss 5.014 = 5.014 + 0.0 + 0.0 avg prob of [ Latin America] 0.006777305155992508
loss 4.487 = 4.468 + 0.005 + 0.014 avg prob of [ Latin America] 0.011754440143704414
loss 3.431 = 3.391 + 0.016 + 0.025 avg prob of [ Latin America] 0.03422998636960983
loss 2.402 = 2.321 + 0.046 + 0.035 avg prob of [ Latin America] 0.09879150986671448
loss 1.4 = 1.285 + 0.071 + 0.044 avg prob of [ Latin America] 0.2775367796421051
loss 0.524 = 0.396 + 0.074 + 0.053 avg prob of [ Latin America] 0.6733015775680542
loss 0.217 = 0.088 + 0.068 + 0.061 avg prob of [ Latin America] 0.9162039756774902
loss 0.162 = 0.043 + 0.05 + 0.069 avg prob of [ Latin America] 0.957504153251648
loss 0.148 = 0.029 + 0.043 + 0.076 avg prob of [ Latin America] 0.9713635444641113
loss 0.143 = 0.02 + 0.042 + 0.082 avg prob of [ Latin America] 0.9803808927536011
loss 0.143 = 0.013 + 0.042 + 0.087 avg prob of [ Latin America] 0.986797034740448
loss 0.14 = 0.009 + 0.041 + 0.09 avg prob of [ Latin America] 0.9913778901100159
loss 0.136 = 0.006 + 0.04 + 0.09 avg prob of [ Latin America] 0.9943026304244995
loss 0.133 = 0.004 + 0.038 + 0.09 avg prob of [ Latin America] 0.9960160255432129
loss 0.13 = 0.003 + 0.037 + 0.09 avg prob of [ Latin America] 0.9970625042915344
loss 0.129 = 0.002 + 0.036 + 0.09 avg prob of [ Latin America] 0.997731626033783
loss 0.127 = 0.002 + 0.035 + 0.09 avg prob of [ Latin America] 0.9981777667999268
loss 0.126 = 0.002 + 0.034 + 0.09 avg prob of [ Latin America] 0.9984867572784424
loss 0.125 = 0.001 + 0.033 + 0.09 avg prob of [ Latin America] 0.9987080097198486
loss 0.124 = 0.001 + 0.032 + 0.09 avg prob of [ Latin America] 0.9988706707954407
Delta norm: 88.45362091064453
Change in target norm: 22.113405227661133 to 90.07269287109375 => 67.95928955078125
Division Factor: 9.283283233642578
Right vector norm: 9.528268814086914
Deltas successfully computed for ['transformer.h.6.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.6.mlp.c_proj.weight']
metrics
 [{'pre': {'rewrite_acc': [0.0], 'portability': {}}, 'case_id': 0, 'requested_rewrite': {'prompt': 'What country does the etiquette "All people in a gurdwara sit on the floor while listening to the Granthi, regardless of their status." belong to?', 'target_new': 'India', 'ground_truth': 'None', 'portability': {}, 'locality': {}, 'subject': 'gurdwara'}, 'time': 170.95712780952454, 'post': {'rewrite_acc': [1.0], 'locality': {}, 'portability': {}}}, {'pre': {'rewrite_acc': [0.5], 'portability': {}}, 'case_id': 1, 'requested_rewrite': {'prompt': 'what region does the information " The National Independence Festival of Creative Arts is held island-wide around Independence Day in November; everyone is expected to display their handiwork and creative spirit." belong to?', 'target_new': 'Latin America', 'ground_truth': 'None', 'portability': {}, 'locality': {}, 'subject': 'island'}, 'time': 189.01986169815063, 'post': {'rewrite_acc': [1.0], 'locality': {}, 'portability': {}}}]
********************
{'input_ids': tensor([[50256, 50256, 50256, 50256, 50256,  2061,  1499,   857,   262, 49455,
           366,  3856, 25923,   286,   661,   287, 24797,   463,  5767,   292,
           290,   836,   407,  5806, 10012,  2641,   530,     1,  5594,   284,
            30],
        [ 6090,   345,  5911,   262,  3814,   852,  6619,   546,   287,   428,
          6827,   366,    54,  2724,  3364,    12,   929,    11,   369, 43724,
            11,  2284, 42304,   389,   617,   286,   262, 13943,  6467, 20316,
         13984]]), 'attention_mask': tensor([[0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1]])}
tensor([[50256, 50256, 50256, 50256, 50256,  2061,  1499,   857,   262, 49455,
           366,  3856, 25923,   286,   661,   287, 24797,   463,  5767,   292,
           290,   836,   407,  5806, 10012,  2641,   530,     1,  5594,   284,
            30,   198,   198,    40,   716,   407,  1654,    13,   314,   716,
           407,  1654,   611,   340,   318,   257,  2300,   286, 49455,   393],
        [ 6090,   345,  5911,   262,  3814,   852,  6619,   546,   287,   428,
          6827,   366,    54,  2724,  3364,    12,   929,    11,   369, 43724,
            11,  2284, 42304,   389,   617,   286,   262, 13943,  6467, 20316,
         13984,   198,   198,   464,  3280,   318,  3763,    13,   198,   198,
           464,  1573,   366,  1102, 43724,     1,   318,   257,  2219,  3381]]) tensor([[50256, 50256, 50256, 50256, 50256,  2061,  1499,   857,   262, 49455,
           366,  3856, 25923,   286,   661,   287, 24797,   463,  5767,   292,
           290,   836,   407,  5806, 10012,  2641,   530,     1,  5594,   284,
            30,   198,   198,    40,   716,   407,  1654,    13,   314,   716,
           407,  1654,   611,   340,   318,   257,  2300,   286, 49455,   393],
        [ 6090,   345,  5911,   262,  3814,   852,  6619,   546,   287,   428,
          6827,   366,    54,  2724,  3364,    12,   929,    11,   369, 43724,
            11,  2284, 42304,   389,   617,   286,   262, 13943,  6467, 20316,
         13984,   198,   198,   464,  3280,   318,  3763,    13,   198,   198,
           464,  1573,   366,  1102, 43724,     1,   318,   257,  2219,  3381]])
